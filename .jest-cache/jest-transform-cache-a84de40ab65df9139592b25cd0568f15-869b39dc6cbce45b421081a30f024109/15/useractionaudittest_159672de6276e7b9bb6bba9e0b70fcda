689759c0cd998f832b03342a93876f5e
"use strict";
/**
 * User Action Audit System Tests
 * Tests for the comprehensive user action and audit logging system
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const vitest_1 = require("vitest");
const user_action_logger_1 = require("../user-action-logger");
const performance_metrics_1 = require("../performance-metrics");
const error_tracking_1 = require("../error-tracking");
const audit_logger_1 = require("../audit-logger");
// Mock the logger dependencies
vitest_1.vi.mock('@/lib/utils/logging', () => ({
    getLogger: vitest_1.vi.fn(() => ({
        info: vitest_1.vi.fn(),
        error: vitest_1.vi.fn(),
        warn: vitest_1.vi.fn(),
        debug: vitest_1.vi.fn(),
        http: vitest_1.vi.fn(),
        verbose: vitest_1.vi.fn(),
        silly: vitest_1.vi.fn(),
        performance: vitest_1.vi.fn(),
        request: vitest_1.vi.fn(),
        database: vitest_1.vi.fn(),
        userAction: vitest_1.vi.fn()
    })),
    performanceLogger: {
        info: vitest_1.vi.fn(),
        error: vitest_1.vi.fn(),
        warn: vitest_1.vi.fn(),
        performance: vitest_1.vi.fn(),
        userAction: vitest_1.vi.fn()
    },
    securityLogger: {
        info: vitest_1.vi.fn(),
        error: vitest_1.vi.fn(),
        warn: vitest_1.vi.fn(),
        userAction: vitest_1.vi.fn()
    }
}));
(0, vitest_1.describe)('User Action Audit System', () => {
    (0, vitest_1.beforeEach)(() => {
        vitest_1.vi.clearAllMocks();
    });
    (0, vitest_1.afterEach)(() => {
        // Clean up any intervals or timers
        performance_metrics_1.performanceMetrics.stopSystemMetricsCollection();
    });
    (0, vitest_1.describe)('User Action Logger', () => {
        (0, vitest_1.it)('should log successful user action', async () => {
            const context = {
                userId: 'user123',
                sessionId: 'session456',
                requestId: 'req789',
                ip: '192.168.1.1',
                userAgent: 'Mozilla/5.0',
                timestamp: new Date()
            };
            const details = {
                action: 'create',
                resource: 'products',
                resourceId: 'product123',
                method: 'POST',
                url: '/api/v1/products',
                statusCode: 201,
                duration: 150,
                success: true,
                metadata: {
                    productName: 'Test Product'
                }
            };
            await (0, user_action_logger_1.logUserAction)(context, details);
            // Verify the action was logged (we can't easily test the internal logging without mocking)
            (0, vitest_1.expect)(true).toBe(true); // Placeholder assertion
        });
        (0, vitest_1.it)('should log failed user action with error details', async () => {
            const context = {
                userId: 'user123',
                sessionId: 'session456',
                requestId: 'req789',
                ip: '192.168.1.1',
                userAgent: 'Mozilla/5.0',
                timestamp: new Date()
            };
            const details = {
                action: 'create',
                resource: 'products',
                method: 'POST',
                url: '/api/v1/products',
                statusCode: 400,
                duration: 50,
                success: false
            };
            const error = new Error('Validation failed');
            await (0, user_action_logger_1.logFailedUserAction)(context, details, error);
            // Verify the failed action was logged
            (0, vitest_1.expect)(true).toBe(true); // Placeholder assertion
        });
        (0, vitest_1.it)('should track user activity summary', () => {
            const summary = user_action_logger_1.userActionLogger.getUserActivitySummary('user123', {
                start: new Date(Date.now() - 3600000), // 1 hour ago
                end: new Date()
            });
            (0, vitest_1.expect)(summary).toHaveProperty('totalActions');
            (0, vitest_1.expect)(summary).toHaveProperty('successfulActions');
            (0, vitest_1.expect)(summary).toHaveProperty('failedActions');
            (0, vitest_1.expect)(summary).toHaveProperty('actionsByType');
            (0, vitest_1.expect)(summary).toHaveProperty('sessionCount');
            (0, vitest_1.expect)(summary).toHaveProperty('lastActivity');
            (0, vitest_1.expect)(summary).toHaveProperty('suspiciousActivity');
        });
    });
    (0, vitest_1.describe)('Performance Metrics', () => {
        (0, vitest_1.it)('should record operation duration', () => {
            (0, performance_metrics_1.recordOperationDuration)('test_operation', 250, {
                userId: 'user123',
                metadata: {
                    operationType: 'database_query'
                }
            });
            // Verify metric was recorded
            (0, vitest_1.expect)(true).toBe(true); // Placeholder assertion
        });
        (0, vitest_1.it)('should record API request metrics', () => {
            performance_metrics_1.performanceMetrics.recordApiRequest('POST', '/api/v1/products', 201, 150, {
                responseSize: 1024,
                requestSize: 512,
                userId: 'user123',
                requestId: 'req789'
            });
            // Verify API metrics were recorded
            (0, vitest_1.expect)(true).toBe(true); // Placeholder assertion
        });
        (0, vitest_1.it)('should get performance summary', () => {
            const summary = performance_metrics_1.performanceMetrics.getPerformanceSummary(new Date(Date.now() - 3600000), // 1 hour ago
            new Date());
            (0, vitest_1.expect)(summary).toHaveProperty('totalMetrics');
            (0, vitest_1.expect)(summary).toHaveProperty('averageDuration');
            (0, vitest_1.expect)(summary).toHaveProperty('slowOperations');
            (0, vitest_1.expect)(summary).toHaveProperty('errorCount');
            (0, vitest_1.expect)(summary).toHaveProperty('memoryPeaks');
        });
        (0, vitest_1.it)('should export metrics in JSON format', () => {
            const jsonMetrics = performance_metrics_1.performanceMetrics.exportMetrics('json');
            (0, vitest_1.expect)(() => JSON.parse(jsonMetrics)).not.toThrow();
            const parsed = JSON.parse(jsonMetrics);
            (0, vitest_1.expect)(parsed).toHaveProperty('timestamp');
            (0, vitest_1.expect)(parsed).toHaveProperty('metrics');
            (0, vitest_1.expect)(parsed).toHaveProperty('summary');
        });
        (0, vitest_1.it)('should export metrics in Prometheus format', () => {
            const prometheusMetrics = performance_metrics_1.performanceMetrics.exportMetrics('prometheus');
            (0, vitest_1.expect)(typeof prometheusMetrics).toBe('string');
            // Prometheus format should contain metric names and values
            (0, vitest_1.expect)(prometheusMetrics).toMatch(/\w+.*\d+\s+\d+/);
        });
    });
    (0, vitest_1.describe)('Error Tracking', () => {
        (0, vitest_1.it)('should track basic error with context', async () => {
            const error = new Error('Test error');
            const context = {
                userId: 'user123',
                sessionId: 'session456',
                requestId: 'req789',
                ip: '192.168.1.1',
                userAgent: 'Mozilla/5.0'
            };
            const errorId = await (0, error_tracking_1.trackError)(error, context, {
                operation: 'test_operation',
                additionalData: 'test'
            });
            (0, vitest_1.expect)(typeof errorId).toBe('string');
            (0, vitest_1.expect)(errorId).toMatch(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i);
        });
        (0, vitest_1.it)('should track API error with request context', async () => {
            const error = new Error('API error');
            const request = {
                method: 'POST',
                url: '/api/v1/products',
                userId: 'user123',
                sessionId: 'session456',
                ip: '192.168.1.1',
                userAgent: 'Mozilla/5.0'
            };
            const errorId = await (0, error_tracking_1.trackApiError)(error, request, {
                statusCode: 500
            });
            (0, vitest_1.expect)(typeof errorId).toBe('string');
            (0, vitest_1.expect)(errorId).toMatch(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i);
        });
        (0, vitest_1.it)('should get error statistics', async () => {
            const { errorTracking } = await Promise.resolve().then(() => __importStar(require('../error-tracking')));
            const stats = errorTracking.getErrorStatistics({
                start: new Date(Date.now() - 3600000), // 1 hour ago
                end: new Date()
            });
            (0, vitest_1.expect)(stats).toHaveProperty('totalErrors');
            (0, vitest_1.expect)(stats).toHaveProperty('errorsByType');
            (0, vitest_1.expect)(stats).toHaveProperty('errorsBySeverity');
            (0, vitest_1.expect)(stats).toHaveProperty('topErrors');
            (0, vitest_1.expect)(stats).toHaveProperty('affectedUsers');
            (0, vitest_1.expect)(stats).toHaveProperty('criticalErrors');
        });
    });
    (0, vitest_1.describe)('Audit Logger Integration', () => {
        (0, vitest_1.it)('should log user action to audit trail', async () => {
            const userId = 'user123';
            const action = {
                action: 'create',
                resource: 'products',
                resourceId: 'product123',
                details: {
                    productName: 'Test Product',
                    price: 29.99
                }
            };
            const context = {
                sessionId: 'session456',
                ip: '192.168.1.1',
                userAgent: 'Mozilla/5.0',
                requestId: 'req789'
            };
            // This should not throw
            await (0, vitest_1.expect)(audit_logger_1.auditLogger.logUserAction(userId, action, context)).resolves.not.toThrow();
        });
        (0, vitest_1.it)('should log security event', async () => {
            const event = {
                type: 'failed_login',
                severity: 'medium',
                details: {
                    reason: 'Invalid password',
                    attempts: 3
                }
            };
            const context = {
                userId: 'user123',
                sessionId: 'session456',
                ip: '192.168.1.1',
                userAgent: 'Mozilla/5.0',
                requestId: 'req789'
            };
            // This should not throw
            await (0, vitest_1.expect)(audit_logger_1.auditLogger.logSecurityEvent(event, context)).resolves.not.toThrow();
        });
        (0, vitest_1.it)('should log performance event', async () => {
            const event = {
                operation: 'database_query',
                duration: 1500,
                threshold: 1000,
                metadata: {
                    query: 'SELECT * FROM products',
                    table: 'products'
                }
            };
            const context = {
                userId: 'user123',
                sessionId: 'session456',
                requestId: 'req789'
            };
            // This should not throw
            await (0, vitest_1.expect)(audit_logger_1.auditLogger.logPerformanceEvent(event, context)).resolves.not.toThrow();
        });
    });
    (0, vitest_1.describe)('Integration Tests', () => {
        (0, vitest_1.it)('should handle complete user action flow', async () => {
            const userId = 'user123';
            const sessionId = 'session456';
            const requestId = 'req789';
            // Simulate a complete user action with all logging
            const startTime = Date.now();
            try {
                // Simulate some work
                await new Promise(resolve => setTimeout(resolve, 100));
                // Log successful action
                await (0, user_action_logger_1.logUserAction)({
                    userId,
                    sessionId,
                    requestId,
                    ip: '192.168.1.1',
                    userAgent: 'Mozilla/5.0',
                    timestamp: new Date()
                }, {
                    action: 'create',
                    resource: 'products',
                    resourceId: 'product123',
                    method: 'POST',
                    url: '/api/v1/products',
                    statusCode: 201,
                    duration: Date.now() - startTime,
                    success: true,
                    metadata: {
                        productName: 'Test Product'
                    }
                });
                // Record performance
                (0, performance_metrics_1.recordOperationDuration)('product_creation', Date.now() - startTime, {
                    userId,
                    sessionId,
                    requestId,
                    metadata: {
                        success: true
                    }
                });
                (0, vitest_1.expect)(true).toBe(true); // If we get here, everything worked
            }
            catch (error) {
                // Log failed action
                await (0, user_action_logger_1.logFailedUserAction)({
                    userId,
                    sessionId,
                    requestId,
                    ip: '192.168.1.1',
                    userAgent: 'Mozilla/5.0',
                    timestamp: new Date()
                }, {
                    action: 'create',
                    resource: 'products',
                    method: 'POST',
                    url: '/api/v1/products',
                    statusCode: 500,
                    duration: Date.now() - startTime,
                    success: false
                }, error);
                // Track the error
                await (0, error_tracking_1.trackError)(error, {
                    userId,
                    sessionId,
                    requestId,
                    ip: '192.168.1.1',
                    userAgent: 'Mozilla/5.0'
                });
                throw error;
            }
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRjpcXFlvdWNsb3VkXFxEb2N1bWVudHNcXFByb2pldHNcXExvZ2lzdGl4XFxsaWJcXHNlcnZpY2VzXFxfX3Rlc3RzX19cXHVzZXItYWN0aW9uLWF1ZGl0LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFSCxtQ0FBeUU7QUFDekUsOERBQTZGO0FBQzdGLGdFQUFxRjtBQUNyRixzREFBOEQ7QUFDOUQsa0RBQThDO0FBRTlDLCtCQUErQjtBQUMvQixXQUFFLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDcEMsU0FBUyxFQUFFLFdBQUUsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUN0QixJQUFJLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUNiLEtBQUssRUFBRSxXQUFFLENBQUMsRUFBRSxFQUFFO1FBQ2QsSUFBSSxFQUFFLFdBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDYixLQUFLLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUNkLElBQUksRUFBRSxXQUFFLENBQUMsRUFBRSxFQUFFO1FBQ2IsT0FBTyxFQUFFLFdBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDaEIsS0FBSyxFQUFFLFdBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDZCxXQUFXLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUNwQixPQUFPLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUNoQixRQUFRLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUNqQixVQUFVLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtLQUNwQixDQUFDLENBQUM7SUFDSCxpQkFBaUIsRUFBRTtRQUNqQixJQUFJLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUNiLEtBQUssRUFBRSxXQUFFLENBQUMsRUFBRSxFQUFFO1FBQ2QsSUFBSSxFQUFFLFdBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDYixXQUFXLEVBQUUs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b0JBQ2hDLE9BQU8sRUFBRSxLQUFLO2lCQUNmLEVBQ0QsS0FBYyxDQUNmLENBQUM7Z0JBRUYsa0JBQWtCO2dCQUNsQixNQUFNLElBQUEsMkJBQVUsRUFBQyxLQUFLLEVBQUU7b0JBQ3RCLE1BQU07b0JBQ04sU0FBUztvQkFDVCxTQUFTO29CQUNULEVBQUUsRUFBRSxhQUFhO29CQUNqQixTQUFTLEVBQUUsYUFBYTtpQkFDekIsQ0FBQyxDQUFDO2dCQUVILE1BQU0sS0FBSyxDQUFDO1lBQ2QsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJGOlxcWW91Y2xvdWRcXERvY3VtZW50c1xcUHJvamV0c1xcTG9naXN0aXhcXGxpYlxcc2VydmljZXNcXF9fdGVzdHNfX1xcdXNlci1hY3Rpb24tYXVkaXQudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogVXNlciBBY3Rpb24gQXVkaXQgU3lzdGVtIFRlc3RzXHJcbiAqIFRlc3RzIGZvciB0aGUgY29tcHJlaGVuc2l2ZSB1c2VyIGFjdGlvbiBhbmQgYXVkaXQgbG9nZ2luZyBzeXN0ZW1cclxuICovXHJcblxyXG5pbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCwgYmVmb3JlRWFjaCwgYWZ0ZXJFYWNoLCB2aSB9IGZyb20gJ3ZpdGVzdCc7XHJcbmltcG9ydCB7IHVzZXJBY3Rpb25Mb2dnZXIsIGxvZ1VzZXJBY3Rpb24sIGxvZ0ZhaWxlZFVzZXJBY3Rpb24gfSBmcm9tICcuLi91c2VyLWFjdGlvbi1sb2dnZXInO1xyXG5pbXBvcnQgeyBwZXJmb3JtYW5jZU1ldHJpY3MsIHJlY29yZE9wZXJhdGlvbkR1cmF0aW9uIH0gZnJvbSAnLi4vcGVyZm9ybWFuY2UtbWV0cmljcyc7XHJcbmltcG9ydCB7IHRyYWNrRXJyb3IsIHRyYWNrQXBpRXJyb3IgfSBmcm9tICcuLi9lcnJvci10cmFja2luZyc7XHJcbmltcG9ydCB7IGF1ZGl0TG9nZ2VyIH0gZnJvbSAnLi4vYXVkaXQtbG9nZ2VyJztcclxuXHJcbi8vIE1vY2sgdGhlIGxvZ2dlciBkZXBlbmRlbmNpZXNcclxudmkubW9jaygnQC9saWIvdXRpbHMvbG9nZ2luZycsICgpID0+ICh7XHJcbiAgZ2V0TG9nZ2VyOiB2aS5mbigoKSA9PiAoe1xyXG4gICAgaW5mbzogdmkuZm4oKSxcclxuICAgIGVycm9yOiB2aS5mbigpLFxyXG4gICAgd2FybjogdmkuZm4oKSxcclxuICAgIGRlYnVnOiB2aS5mbigpLFxyXG4gICAgaHR0cDogdmkuZm4oKSxcclxuICAgIHZlcmJvc2U6IHZpLmZuKCksXHJcbiAgICBzaWxseTogdmkuZm4oKSxcclxuICAgIHBlcmZvcm1hbmNlOiB2aS5mbigpLFxyXG4gICAgcmVxdWVzdDogdmkuZm4oKSxcclxuICAgIGRhdGFiYXNlOiB2aS5mbigpLFxyXG4gICAgdXNlckFjdGlvbjogdmkuZm4oKVxyXG4gIH0pKSxcclxuICBwZXJmb3JtYW5jZUxvZ2dlcjoge1xyXG4gICAgaW5mbzogdmkuZm4oKSxcclxuICAgIGVycm9yOiB2aS5mbigpLFxyXG4gICAgd2FybjogdmkuZm4oKSxcclxuICAgIHBlcmZvcm1hbmNlOiB2aS5mbigpLFxyXG4gICAgdXNlckFjdGlvbjogdmkuZm4oKVxyXG4gIH0sXHJcbiAgc2VjdXJpdHlMb2dnZXI6IHtcclxuICAgIGluZm86IHZpLmZuKCksXHJcbiAgICBlcnJvcjogdmkuZm4oKSxcclxuICAgIHdhcm46IHZpLmZuKCksXHJcbiAgICB1c2VyQWN0aW9uOiB2aS5mbigpXHJcbiAgfVxyXG59KSk7XHJcblxyXG5kZXNjcmliZSgnVXNlciBBY3Rpb24gQXVkaXQgU3lzdGVtJywgKCkgPT4ge1xyXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgdmkuY2xlYXJBbGxNb2NrcygpO1xyXG4gIH0pO1xyXG5cclxuICBhZnRlckVhY2goKCkgPT4ge1xyXG4gICAgLy8gQ2xlYW4gdXAgYW55IGludGVydmFscyBvciB0aW1lcnNcclxuICAgIHBlcmZvcm1hbmNlTWV0cmljcy5zdG9wU3lzdGVtTWV0cmljc0NvbGxlY3Rpb24oKTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1VzZXIgQWN0aW9uIExvZ2dlcicsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgbG9nIHN1Y2Nlc3NmdWwgdXNlciBhY3Rpb24nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbnRleHQgPSB7XHJcbiAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXHJcbiAgICAgICAgc2Vzc2lvbklkOiAnc2Vzc2lvbjQ1NicsXHJcbiAgICAgICAgcmVxdWVzdElkOiAncmVxNzg5JyxcclxuICAgICAgICBpcDogJzE5Mi4xNjguMS4xJyxcclxuICAgICAgICB1c2VyQWdlbnQ6ICdNb3ppbGxhLzUuMCcsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCBkZXRhaWxzID0ge1xyXG4gICAgICAgIGFjdGlvbjogJ2NyZWF0ZScsXHJcbiAgICAgICAgcmVzb3VyY2U6ICdwcm9kdWN0cycsXHJcbiAgICAgICAgcmVzb3VyY2VJZDogJ3Byb2R1Y3QxMjMnLFxyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIHVybDogJy9hcGkvdjEvcHJvZHVjdHMnLFxyXG4gICAgICAgIHN0YXR1c0NvZGU6IDIwMSxcclxuICAgICAgICBkdXJhdGlvbjogMTUwLFxyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgIHByb2R1Y3ROYW1lOiAnVGVzdCBQcm9kdWN0J1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIGF3YWl0IGxvZ1VzZXJBY3Rpb24oY29udGV4dCwgZGV0YWlscyk7XHJcblxyXG4gICAgICAvLyBWZXJpZnkgdGhlIGFjdGlvbiB3YXMgbG9nZ2VkICh3ZSBjYW4ndCBlYXNpbHkgdGVzdCB0aGUgaW50ZXJuYWwgbG9nZ2luZyB3aXRob3V0IG1vY2tpbmcpXHJcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBQbGFjZWhvbGRlciBhc3NlcnRpb25cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgbG9nIGZhaWxlZCB1c2VyIGFjdGlvbiB3aXRoIGVycm9yIGRldGFpbHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbnRleHQgPSB7XHJcbiAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXHJcbiAgICAgICAgc2Vzc2lvbklkOiAnc2Vzc2lvbjQ1NicsXHJcbiAgICAgICAgcmVxdWVzdElkOiAncmVxNzg5JyxcclxuICAgICAgICBpcDogJzE5Mi4xNjguMS4xJyxcclxuICAgICAgICB1c2VyQWdlbnQ6ICdNb3ppbGxhLzUuMCcsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCBkZXRhaWxzID0ge1xyXG4gICAgICAgIGFjdGlvbjogJ2NyZWF0ZScsXHJcbiAgICAgICAgcmVzb3VyY2U6ICdwcm9kdWN0cycsXHJcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgdXJsOiAnL2FwaS92MS9wcm9kdWN0cycsXHJcbiAgICAgICAgc3RhdHVzQ29kZTogNDAwLFxyXG4gICAgICAgIGR1cmF0aW9uOiA1MCxcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1ZhbGlkYXRpb24gZmFpbGVkJyk7XHJcblxyXG4gICAgICBhd2FpdCBsb2dGYWlsZWRVc2VyQWN0aW9uKGNvbnRleHQsIGRldGFpbHMsIGVycm9yKTtcclxuXHJcbiAgICAgIC8vIFZlcmlmeSB0aGUgZmFpbGVkIGFjdGlvbiB3YXMgbG9nZ2VkXHJcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBQbGFjZWhvbGRlciBhc3NlcnRpb25cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgdHJhY2sgdXNlciBhY3Rpdml0eSBzdW1tYXJ5JywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzdW1tYXJ5ID0gdXNlckFjdGlvbkxvZ2dlci5nZXRVc2VyQWN0aXZpdHlTdW1tYXJ5KFxyXG4gICAgICAgICd1c2VyMTIzJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzdGFydDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDM2MDAwMDApLCAvLyAxIGhvdXIgYWdvXHJcbiAgICAgICAgICBlbmQ6IG5ldyBEYXRlKClcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBleHBlY3Qoc3VtbWFyeSkudG9IYXZlUHJvcGVydHkoJ3RvdGFsQWN0aW9ucycpO1xyXG4gICAgICBleHBlY3Qoc3VtbWFyeSkudG9IYXZlUHJvcGVydHkoJ3N1Y2Nlc3NmdWxBY3Rpb25zJyk7XHJcbiAgICAgIGV4cGVjdChzdW1tYXJ5KS50b0hhdmVQcm9wZXJ0eSgnZmFpbGVkQWN0aW9ucycpO1xyXG4gICAgICBleHBlY3Qoc3VtbWFyeSkudG9IYXZlUHJvcGVydHkoJ2FjdGlvbnNCeVR5cGUnKTtcclxuICAgICAgZXhwZWN0KHN1bW1hcnkpLnRvSGF2ZVByb3BlcnR5KCdzZXNzaW9uQ291bnQnKTtcclxuICAgICAgZXhwZWN0KHN1bW1hcnkpLnRvSGF2ZVByb3BlcnR5KCdsYXN0QWN0aXZpdHknKTtcclxuICAgICAgZXhwZWN0KHN1bW1hcnkpLnRvSGF2ZVByb3BlcnR5KCdzdXNwaWNpb3VzQWN0aXZpdHknKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnUGVyZm9ybWFuY2UgTWV0cmljcycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgcmVjb3JkIG9wZXJhdGlvbiBkdXJhdGlvbicsICgpID0+IHtcclxuICAgICAgcmVjb3JkT3BlcmF0aW9uRHVyYXRpb24oJ3Rlc3Rfb3BlcmF0aW9uJywgMjUwLCB7XHJcbiAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXHJcbiAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgIG9wZXJhdGlvblR5cGU6ICdkYXRhYmFzZV9xdWVyeSdcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gVmVyaWZ5IG1ldHJpYyB3YXMgcmVjb3JkZWRcclxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIFBsYWNlaG9sZGVyIGFzc2VydGlvblxyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZWNvcmQgQVBJIHJlcXVlc3QgbWV0cmljcycsICgpID0+IHtcclxuICAgICAgcGVyZm9ybWFuY2VNZXRyaWNzLnJlY29yZEFwaVJlcXVlc3QoXHJcbiAgICAgICAgJ1BPU1QnLFxyXG4gICAgICAgICcvYXBpL3YxL3Byb2R1Y3RzJyxcclxuICAgICAgICAyMDEsXHJcbiAgICAgICAgMTUwLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHJlc3BvbnNlU2l6ZTogMTAyNCxcclxuICAgICAgICAgIHJlcXVlc3RTaXplOiA1MTIsXHJcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcclxuICAgICAgICAgIHJlcXVlc3RJZDogJ3JlcTc4OSdcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcblxyXG4gICAgICAvLyBWZXJpZnkgQVBJIG1ldHJpY3Mgd2VyZSByZWNvcmRlZFxyXG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gUGxhY2Vob2xkZXIgYXNzZXJ0aW9uXHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGdldCBwZXJmb3JtYW5jZSBzdW1tYXJ5JywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzdW1tYXJ5ID0gcGVyZm9ybWFuY2VNZXRyaWNzLmdldFBlcmZvcm1hbmNlU3VtbWFyeShcclxuICAgICAgICBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMzYwMDAwMCksIC8vIDEgaG91ciBhZ29cclxuICAgICAgICBuZXcgRGF0ZSgpXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBleHBlY3Qoc3VtbWFyeSkudG9IYXZlUHJvcGVydHkoJ3RvdGFsTWV0cmljcycpO1xyXG4gICAgICBleHBlY3Qoc3VtbWFyeSkudG9IYXZlUHJvcGVydHkoJ2F2ZXJhZ2VEdXJhdGlvbicpO1xyXG4gICAgICBleHBlY3Qoc3VtbWFyeSkudG9IYXZlUHJvcGVydHkoJ3Nsb3dPcGVyYXRpb25zJyk7XHJcbiAgICAgIGV4cGVjdChzdW1tYXJ5KS50b0hhdmVQcm9wZXJ0eSgnZXJyb3JDb3VudCcpO1xyXG4gICAgICBleHBlY3Qoc3VtbWFyeSkudG9IYXZlUHJvcGVydHkoJ21lbW9yeVBlYWtzJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGV4cG9ydCBtZXRyaWNzIGluIEpTT04gZm9ybWF0JywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBqc29uTWV0cmljcyA9IHBlcmZvcm1hbmNlTWV0cmljcy5leHBvcnRNZXRyaWNzKCdqc29uJyk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QoKCkgPT4gSlNPTi5wYXJzZShqc29uTWV0cmljcykpLm5vdC50b1Rocm93KCk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGpzb25NZXRyaWNzKTtcclxuICAgICAgZXhwZWN0KHBhcnNlZCkudG9IYXZlUHJvcGVydHkoJ3RpbWVzdGFtcCcpO1xyXG4gICAgICBleHBlY3QocGFyc2VkKS50b0hhdmVQcm9wZXJ0eSgnbWV0cmljcycpO1xyXG4gICAgICBleHBlY3QocGFyc2VkKS50b0hhdmVQcm9wZXJ0eSgnc3VtbWFyeScpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBleHBvcnQgbWV0cmljcyBpbiBQcm9tZXRoZXVzIGZvcm1hdCcsICgpID0+IHtcclxuICAgICAgY29uc3QgcHJvbWV0aGV1c01ldHJpY3MgPSBwZXJmb3JtYW5jZU1ldHJpY3MuZXhwb3J0TWV0cmljcygncHJvbWV0aGV1cycpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHR5cGVvZiBwcm9tZXRoZXVzTWV0cmljcykudG9CZSgnc3RyaW5nJyk7XHJcbiAgICAgIC8vIFByb21ldGhldXMgZm9ybWF0IHNob3VsZCBjb250YWluIG1ldHJpYyBuYW1lcyBhbmQgdmFsdWVzXHJcbiAgICAgIGV4cGVjdChwcm9tZXRoZXVzTWV0cmljcykudG9NYXRjaCgvXFx3Ky4qXFxkK1xccytcXGQrLyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0Vycm9yIFRyYWNraW5nJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCB0cmFjayBiYXNpYyBlcnJvciB3aXRoIGNvbnRleHQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdUZXN0IGVycm9yJyk7XHJcbiAgICAgIGNvbnN0IGNvbnRleHQgPSB7XHJcbiAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXHJcbiAgICAgICAgc2Vzc2lvbklkOiAnc2Vzc2lvbjQ1NicsXHJcbiAgICAgICAgcmVxdWVzdElkOiAncmVxNzg5JyxcclxuICAgICAgICBpcDogJzE5Mi4xNjguMS4xJyxcclxuICAgICAgICB1c2VyQWdlbnQ6ICdNb3ppbGxhLzUuMCdcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IGVycm9ySWQgPSBhd2FpdCB0cmFja0Vycm9yKGVycm9yLCBjb250ZXh0LCB7XHJcbiAgICAgICAgb3BlcmF0aW9uOiAndGVzdF9vcGVyYXRpb24nLFxyXG4gICAgICAgIGFkZGl0aW9uYWxEYXRhOiAndGVzdCdcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBleHBlY3QodHlwZW9mIGVycm9ySWQpLnRvQmUoJ3N0cmluZycpO1xyXG4gICAgICBleHBlY3QoZXJyb3JJZCkudG9NYXRjaCgvXlswLTlhLWZdezh9LVswLTlhLWZdezR9LVswLTlhLWZdezR9LVswLTlhLWZdezR9LVswLTlhLWZdezEyfSQvaSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHRyYWNrIEFQSSBlcnJvciB3aXRoIHJlcXVlc3QgY29udGV4dCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0FQSSBlcnJvcicpO1xyXG4gICAgICBjb25zdCByZXF1ZXN0ID0ge1xyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIHVybDogJy9hcGkvdjEvcHJvZHVjdHMnLFxyXG4gICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxyXG4gICAgICAgIHNlc3Npb25JZDogJ3Nlc3Npb240NTYnLFxyXG4gICAgICAgIGlwOiAnMTkyLjE2OC4xLjEnLFxyXG4gICAgICAgIHVzZXJBZ2VudDogJ01vemlsbGEvNS4wJ1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgZXJyb3JJZCA9IGF3YWl0IHRyYWNrQXBpRXJyb3IoZXJyb3IsIHJlcXVlc3QsIHtcclxuICAgICAgICBzdGF0dXNDb2RlOiA1MDBcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBleHBlY3QodHlwZW9mIGVycm9ySWQpLnRvQmUoJ3N0cmluZycpO1xyXG4gICAgICBleHBlY3QoZXJyb3JJZCkudG9NYXRjaCgvXlswLTlhLWZdezh9LVswLTlhLWZdezR9LVswLTlhLWZdezR9LVswLTlhLWZdezR9LVswLTlhLWZdezEyfSQvaSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGdldCBlcnJvciBzdGF0aXN0aWNzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB7IGVycm9yVHJhY2tpbmcgfSA9IGF3YWl0IGltcG9ydCgnLi4vZXJyb3ItdHJhY2tpbmcnKTtcclxuICAgICAgY29uc3Qgc3RhdHMgPSBlcnJvclRyYWNraW5nLmdldEVycm9yU3RhdGlzdGljcyh7XHJcbiAgICAgICAgc3RhcnQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSAzNjAwMDAwKSwgLy8gMSBob3VyIGFnb1xyXG4gICAgICAgIGVuZDogbmV3IERhdGUoKVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ3RvdGFsRXJyb3JzJyk7XHJcbiAgICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ2Vycm9yc0J5VHlwZScpO1xyXG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdlcnJvcnNCeVNldmVyaXR5Jyk7XHJcbiAgICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ3RvcEVycm9ycycpO1xyXG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdhZmZlY3RlZFVzZXJzJyk7XHJcbiAgICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ2NyaXRpY2FsRXJyb3JzJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0F1ZGl0IExvZ2dlciBJbnRlZ3JhdGlvbicsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgbG9nIHVzZXIgYWN0aW9uIHRvIGF1ZGl0IHRyYWlsJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB1c2VySWQgPSAndXNlcjEyMyc7XHJcbiAgICAgIGNvbnN0IGFjdGlvbiA9IHtcclxuICAgICAgICBhY3Rpb246ICdjcmVhdGUnLFxyXG4gICAgICAgIHJlc291cmNlOiAncHJvZHVjdHMnLFxyXG4gICAgICAgIHJlc291cmNlSWQ6ICdwcm9kdWN0MTIzJyxcclxuICAgICAgICBkZXRhaWxzOiB7XHJcbiAgICAgICAgICBwcm9kdWN0TmFtZTogJ1Rlc3QgUHJvZHVjdCcsXHJcbiAgICAgICAgICBwcmljZTogMjkuOTlcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIGNvbnN0IGNvbnRleHQgPSB7XHJcbiAgICAgICAgc2Vzc2lvbklkOiAnc2Vzc2lvbjQ1NicsXHJcbiAgICAgICAgaXA6ICcxOTIuMTY4LjEuMScsXHJcbiAgICAgICAgdXNlckFnZW50OiAnTW96aWxsYS81LjAnLFxyXG4gICAgICAgIHJlcXVlc3RJZDogJ3JlcTc4OSdcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIFRoaXMgc2hvdWxkIG5vdCB0aHJvd1xyXG4gICAgICBhd2FpdCBleHBlY3QoYXVkaXRMb2dnZXIubG9nVXNlckFjdGlvbih1c2VySWQsIGFjdGlvbiwgY29udGV4dCkpLnJlc29sdmVzLm5vdC50b1Rocm93KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGxvZyBzZWN1cml0eSBldmVudCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZXZlbnQgPSB7XHJcbiAgICAgICAgdHlwZTogJ2ZhaWxlZF9sb2dpbicgYXMgY29uc3QsXHJcbiAgICAgICAgc2V2ZXJpdHk6ICdtZWRpdW0nIGFzIGNvbnN0LFxyXG4gICAgICAgIGRldGFpbHM6IHtcclxuICAgICAgICAgIHJlYXNvbjogJ0ludmFsaWQgcGFzc3dvcmQnLFxyXG4gICAgICAgICAgYXR0ZW1wdHM6IDNcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIGNvbnN0IGNvbnRleHQgPSB7XHJcbiAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXHJcbiAgICAgICAgc2Vzc2lvbklkOiAnc2Vzc2lvbjQ1NicsXHJcbiAgICAgICAgaXA6ICcxOTIuMTY4LjEuMScsXHJcbiAgICAgICAgdXNlckFnZW50OiAnTW96aWxsYS81LjAnLFxyXG4gICAgICAgIHJlcXVlc3RJZDogJ3JlcTc4OSdcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIFRoaXMgc2hvdWxkIG5vdCB0aHJvd1xyXG4gICAgICBhd2FpdCBleHBlY3QoYXVkaXRMb2dnZXIubG9nU2VjdXJpdHlFdmVudChldmVudCwgY29udGV4dCkpLnJlc29sdmVzLm5vdC50b1Rocm93KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGxvZyBwZXJmb3JtYW5jZSBldmVudCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZXZlbnQgPSB7XHJcbiAgICAgICAgb3BlcmF0aW9uOiAnZGF0YWJhc2VfcXVlcnknLFxyXG4gICAgICAgIGR1cmF0aW9uOiAxNTAwLFxyXG4gICAgICAgIHRocmVzaG9sZDogMTAwMCxcclxuICAgICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgICAgcXVlcnk6ICdTRUxFQ1QgKiBGUk9NIHByb2R1Y3RzJyxcclxuICAgICAgICAgIHRhYmxlOiAncHJvZHVjdHMnXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICBjb25zdCBjb250ZXh0ID0ge1xyXG4gICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxyXG4gICAgICAgIHNlc3Npb25JZDogJ3Nlc3Npb240NTYnLFxyXG4gICAgICAgIHJlcXVlc3RJZDogJ3JlcTc4OSdcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIFRoaXMgc2hvdWxkIG5vdCB0aHJvd1xyXG4gICAgICBhd2FpdCBleHBlY3QoYXVkaXRMb2dnZXIubG9nUGVyZm9ybWFuY2VFdmVudChldmVudCwgY29udGV4dCkpLnJlc29sdmVzLm5vdC50b1Rocm93KCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0ludGVncmF0aW9uIFRlc3RzJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgdXNlciBhY3Rpb24gZmxvdycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgdXNlcklkID0gJ3VzZXIxMjMnO1xyXG4gICAgICBjb25zdCBzZXNzaW9uSWQgPSAnc2Vzc2lvbjQ1Nic7XHJcbiAgICAgIGNvbnN0IHJlcXVlc3RJZCA9ICdyZXE3ODknO1xyXG4gICAgICBcclxuICAgICAgLy8gU2ltdWxhdGUgYSBjb21wbGV0ZSB1c2VyIGFjdGlvbiB3aXRoIGFsbCBsb2dnaW5nXHJcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIFNpbXVsYXRlIHNvbWUgd29ya1xyXG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2cgc3VjY2Vzc2Z1bCBhY3Rpb25cclxuICAgICAgICBhd2FpdCBsb2dVc2VyQWN0aW9uKFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgICAgIHNlc3Npb25JZCxcclxuICAgICAgICAgICAgcmVxdWVzdElkLFxyXG4gICAgICAgICAgICBpcDogJzE5Mi4xNjguMS4xJyxcclxuICAgICAgICAgICAgdXNlckFnZW50OiAnTW96aWxsYS81LjAnLFxyXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGFjdGlvbjogJ2NyZWF0ZScsXHJcbiAgICAgICAgICAgIHJlc291cmNlOiAncHJvZHVjdHMnLFxyXG4gICAgICAgICAgICByZXNvdXJjZUlkOiAncHJvZHVjdDEyMycsXHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3YxL3Byb2R1Y3RzJyxcclxuICAgICAgICAgICAgc3RhdHVzQ29kZTogMjAxLFxyXG4gICAgICAgICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgICBwcm9kdWN0TmFtZTogJ1Rlc3QgUHJvZHVjdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIFJlY29yZCBwZXJmb3JtYW5jZVxyXG4gICAgICAgIHJlY29yZE9wZXJhdGlvbkR1cmF0aW9uKCdwcm9kdWN0X2NyZWF0aW9uJywgRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSwge1xyXG4gICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgc2Vzc2lvbklkLFxyXG4gICAgICAgICAgcmVxdWVzdElkLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gSWYgd2UgZ2V0IGhlcmUsIGV2ZXJ5dGhpbmcgd29ya2VkXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgLy8gTG9nIGZhaWxlZCBhY3Rpb25cclxuICAgICAgICBhd2FpdCBsb2dGYWlsZWRVc2VyQWN0aW9uKFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgICAgIHNlc3Npb25JZCxcclxuICAgICAgICAgICAgcmVxdWVzdElkLFxyXG4gICAgICAgICAgICBpcDogJzE5Mi4xNjguMS4xJyxcclxuICAgICAgICAgICAgdXNlckFnZW50OiAnTW96aWxsYS81LjAnLFxyXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGFjdGlvbjogJ2NyZWF0ZScsXHJcbiAgICAgICAgICAgIHJlc291cmNlOiAncHJvZHVjdHMnLFxyXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS92MS9wcm9kdWN0cycsXHJcbiAgICAgICAgICAgIHN0YXR1c0NvZGU6IDUwMCxcclxuICAgICAgICAgICAgZHVyYXRpb246IERhdGUubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgZXJyb3IgYXMgRXJyb3JcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBUcmFjayB0aGUgZXJyb3JcclxuICAgICAgICBhd2FpdCB0cmFja0Vycm9yKGVycm9yLCB7XHJcbiAgICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgICBzZXNzaW9uSWQsXHJcbiAgICAgICAgICByZXF1ZXN0SWQsXHJcbiAgICAgICAgICBpcDogJzE5Mi4xNjguMS4xJyxcclxuICAgICAgICAgIHVzZXJBZ2VudDogJ01vemlsbGEvNS4wJ1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==