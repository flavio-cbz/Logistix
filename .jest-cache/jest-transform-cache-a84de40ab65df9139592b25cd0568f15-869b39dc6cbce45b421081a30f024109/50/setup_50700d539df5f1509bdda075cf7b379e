4a5979f99243a64d02d7d68d62081a02
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.expectToResolve = exports.expectToThrow = exports.flushPromises = exports.waitForPromises = exports.ServiceTestUtils = exports.DatabaseTestUtils = exports.createMockSession = exports.createMockProduct = exports.createMockParcelle = exports.createMockUser = exports.createMockDatabase = exports.createMockResponse = exports.createMockRequest = void 0;
const globals_1 = require("@jest/globals");
// Mock Next.js modules
globals_1.jest.mock('next/headers', () => ({
    cookies: globals_1.jest.fn(() => ({
        get: globals_1.jest.fn(),
        set: globals_1.jest.fn(),
        delete: globals_1.jest.fn(),
        has: globals_1.jest.fn()
    })),
    headers: globals_1.jest.fn(() => ({
        get: globals_1.jest.fn(),
        set: globals_1.jest.fn(),
        has: globals_1.jest.fn(),
        delete: globals_1.jest.fn()
    }))
}));
globals_1.jest.mock('next/navigation', () => ({
    redirect: globals_1.jest.fn(),
    notFound: globals_1.jest.fn()
}));
// Mock database
globals_1.jest.mock('better-sqlite3', () => {
    return globals_1.jest.fn().mockImplementation(() => ({
        prepare: globals_1.jest.fn().mockReturnValue({
            run: globals_1.jest.fn(),
            get: globals_1.jest.fn(),
            all: globals_1.jest.fn()
        }),
        exec: globals_1.jest.fn(),
        close: globals_1.jest.fn(),
        pragma: globals_1.jest.fn(),
        transaction: globals_1.jest.fn().mockImplementation((fn) => fn)
    }));
});
// Mock bcrypt
globals_1.jest.mock('bcrypt', () => ({
    hash: globals_1.jest.fn().mockResolvedValue('hashed-password'),
    compare: globals_1.jest.fn().mockResolvedValue(true),
    genSalt: globals_1.jest.fn().mockResolvedValue('salt')
}));
// Mock jsonwebtoken
globals_1.jest.mock('jsonwebtoken', () => ({
    sign: globals_1.jest.fn().mockReturnValue('mock-jwt-token'),
    verify: globals_1.jest.fn().mockReturnValue({ userId: 'test-user-id', role: 'user' }),
    decode: globals_1.jest.fn().mockReturnValue({ userId: 'test-user-id', role: 'user' })
}));
// Mock winston logger
globals_1.jest.mock('winston', () => ({
    createLogger: globals_1.jest.fn().mockReturnValue({
        info: globals_1.jest.fn(),
        error: globals_1.jest.fn(),
        warn: globals_1.jest.fn(),
        debug: globals_1.jest.fn()
    }),
    format: {
        combine: globals_1.jest.fn(),
        timestamp: globals_1.jest.fn(),
        errors: globals_1.jest.fn(),
        json: globals_1.jest.fn(),
        printf: globals_1.jest.fn()
    },
    transports: {
        Console: globals_1.jest.fn(),
        File: globals_1.jest.fn()
    }
}));
// Mock winston-daily-rotate-file
globals_1.jest.mock('winston-daily-rotate-file', () => globals_1.jest.fn());
// Global test setup for backend tests
beforeAll(async () => {
    // Set test environment variables
    process.env.NODE_ENV = 'test';
    process.env.DATABASE_URL = ':memory:';
    process.env.JWT_SECRET = 'test-jwt-secret';
    process.env.BCRYPT_ROUNDS = '4'; // Faster hashing for tests
    // Suppress console output in tests unless debugging
    if (!process.env.DEBUG_TESTS) {
        console.log = globals_1.jest.fn();
        console.info = globals_1.jest.fn();
        console.warn = globals_1.jest.fn();
        console.error = globals_1.jest.fn();
    }
});
beforeEach(() => {
    // Clear all mocks before each test
    globals_1.jest.clearAllMocks();
    globals_1.jest.clearAllTimers();
    // Use fake timers for consistent testing
    globals_1.jest.useFakeTimers();
});
afterEach(() => {
    // Restore real timers
    globals_1.jest.useRealTimers();
    // Reset modules to ensure clean state
    globals_1.jest.resetModules();
});
afterAll(async () => {
    // Cleanup any global resources
    await new Promise(resolve => setTimeout(resolve, 100));
});
// Global mocks
global.fetch = globals_1.jest.fn();
// Test utilities
const createMockRequest = (overrides = {}) => ({
    method: 'GET',
    url: '/test',
    headers: {},
    body: null,
    query: {},
    params: {},
    ...overrides
});
exports.createMockRequest = createMockRequest;
const createMockResponse = () => {
    const res = {
        status: globals_1.jest.fn().mockReturnThis(),
        json: globals_1.jest.fn().mockReturnThis(),
        send: globals_1.jest.fn().mockReturnThis(),
        end: globals_1.jest.fn().mockReturnThis(),
        setHeader: globals_1.jest.fn().mockReturnThis(),
        getHeader: globals_1.jest.fn(),
        headers: {},
        statusCode: 200
    };
    return res;
};
exports.createMockResponse = createMockResponse;
const createMockDatabase = () => {
    const mockDb = {
        prepare: globals_1.jest.fn().mockReturnValue({
            run: globals_1.jest.fn().mockReturnValue({ changes: 1, lastInsertRowid: 1 }),
            get: globals_1.jest.fn().mockReturnValue(null),
            all: globals_1.jest.fn().mockReturnValue([])
        }),
        exec: globals_1.jest.fn(),
        close: globals_1.jest.fn(),
        pragma: globals_1.jest.fn(),
        transaction: globals_1.jest.fn().mockImplementation((fn) => fn)
    };
    return mockDb;
};
exports.createMockDatabase = createMockDatabase;
const createMockUser = (overrides = {}) => ({
    id: 'test-user-id',
    username: 'testuser',
    email: 'test@example.com',
    password: 'hashed-password',
    role: 'user',
    profile: JSON.stringify({
        firstName: 'Test',
        lastName: 'User',
        theme: 'system'
    }),
    created_at: new Date().toISOString(),
    updated_at: new Date().toISOString(),
    ...overrides
});
exports.createMockUser = createMockUser;
const createMockParcelle = (overrides = {}) => ({
    id: 'test-parcelle-id',
    numero: 'P001',
    transporteur: 'DHL',
    poids: 1.5,
    prix_achat: 25.50,
    date_creation: new Date().toISOString(),
    user_id: 'test-user-id',
    notes: 'Test parcelle',
    status: 'active',
    ...overrides
});
exports.createMockParcelle = createMockParcelle;
const createMockProduct = (overrides = {}) => ({
    id: 'test-product-id',
    nom: 'Test Product',
    prix: 15.99,
    quantite: 1,
    parcelle_id: 'test-parcelle-id',
    description: 'Test product description',
    status: 'available',
    date_creation: new Date().toISOString(),
    date_vente: null,
    prix_vente: null,
    plateforme: null,
    frais_vente: 0,
    benefice: null,
    images: null,
    tags: null,
    ...overrides
});
exports.createMockProduct = createMockProduct;
const createMockSession = (overrides = {}) => ({
    id: 'test-session-id',
    user_id: 'test-user-id',
    token: 'mock-jwt-token',
    expires_at: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
    created_at: new Date().toISOString(),
    ...overrides
});
exports.createMockSession = createMockSession;
// Database test utilities
class DatabaseTestUtils {
    static createInMemoryDatabase() {
        // In test environment, return a mock database
        return (0, exports.createMockDatabase)();
    }
    static async initializeTestSchema(db) {
        const schema = `
      CREATE TABLE IF NOT EXISTS users (
        id TEXT PRIMARY KEY,
        username TEXT UNIQUE NOT NULL,
        email TEXT UNIQUE NOT NULL,
        password TEXT NOT NULL,
        role TEXT DEFAULT 'user',
        profile TEXT,
        created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
        updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
      );

      CREATE TABLE IF NOT EXISTS parcelles (
        id TEXT PRIMARY KEY,
        numero TEXT UNIQUE NOT NULL,
        transporteur TEXT NOT NULL,
        poids REAL NOT NULL,
        prix_achat REAL NOT NULL,
        date_creation DATETIME DEFAULT CURRENT_TIMESTAMP,
        user_id TEXT NOT NULL,
        notes TEXT,
        status TEXT DEFAULT 'active',
        FOREIGN KEY (user_id) REFERENCES users (id)
      );

      CREATE TABLE IF NOT EXISTS products (
        id TEXT PRIMARY KEY,
        nom TEXT NOT NULL,
        prix REAL NOT NULL,
        quantite INTEGER NOT NULL,
        parcelle_id TEXT NOT NULL,
        description TEXT,
        status TEXT DEFAULT 'available',
        date_creation DATETIME DEFAULT CURRENT_TIMESTAMP,
        date_vente DATETIME,
        prix_vente REAL,
        plateforme TEXT,
        frais_vente REAL DEFAULT 0,
        benefice REAL,
        images TEXT,
        tags TEXT,
        FOREIGN KEY (parcelle_id) REFERENCES parcelles (id)
      );

      CREATE TABLE IF NOT EXISTS sessions (
        id TEXT PRIMARY KEY,
        user_id TEXT NOT NULL,
        token TEXT UNIQUE NOT NULL,
        expires_at DATETIME NOT NULL,
        created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (user_id) REFERENCES users (id)
      );
    `;
        db.exec(schema);
    }
    static async seedTestData(db) {
        const user = (0, exports.createMockUser)();
        const parcelle = (0, exports.createMockParcelle)();
        const product = (0, exports.createMockProduct)();
        const session = (0, exports.createMockSession)();
        // Insert test data
        db.prepare(`
      INSERT INTO users (id, username, email, password, role, profile)
      VALUES (?, ?, ?, ?, ?, ?)
    `).run(user.id, user.username, user.email, user.password, user.role, user.profile);
        db.prepare(`
      INSERT INTO parcelles (id, numero, transporteur, poids, prix_achat, user_id, notes, status)
      VALUES (?, ?, ?, ?, ?, ?, ?, ?)
    `).run(parcelle.id, parcelle.numero, parcelle.transporteur, parcelle.poids, parcelle.prix_achat, parcelle.user_id, parcelle.notes, parcelle.status);
        db.prepare(`
      INSERT INTO products (id, nom, prix, quantite, parcelle_id, description, status)
      VALUES (?, ?, ?, ?, ?, ?, ?)
    `).run(product.id, product.nom, product.prix, product.quantite, product.parcelle_id, product.description, product.status);
        db.prepare(`
      INSERT INTO sessions (id, user_id, token, expires_at)
      VALUES (?, ?, ?, ?)
    `).run(session.id, session.user_id, session.token, session.expires_at);
        return { user, parcelle, product, session };
    }
    static async cleanDatabase(db) {
        const tables = ['sessions', 'products', 'parcelles', 'users'];
        for (const table of tables) {
            db.exec(`DELETE FROM ${table}`);
        }
    }
}
exports.DatabaseTestUtils = DatabaseTestUtils;
// Service test utilities
class ServiceTestUtils {
    static createMockLogger() {
        return {
            info: globals_1.jest.fn(),
            error: globals_1.jest.fn(),
            warn: globals_1.jest.fn(),
            debug: globals_1.jest.fn()
        };
    }
    static createMockAuthService() {
        return {
            validateCredentials: globals_1.jest.fn().mockResolvedValue(true),
            hashPassword: globals_1.jest.fn().mockResolvedValue('hashed-password'),
            comparePassword: globals_1.jest.fn().mockResolvedValue(true),
            generateToken: globals_1.jest.fn().mockReturnValue('mock-token'),
            validateToken: globals_1.jest.fn().mockReturnValue({ userId: 'test-user-id', role: 'user' }),
            createSession: globals_1.jest.fn().mockResolvedValue((0, exports.createMockSession)()),
            validateSession: globals_1.jest.fn().mockResolvedValue((0, exports.createMockSession)()),
            destroySession: globals_1.jest.fn().mockResolvedValue(true)
        };
    }
    static createMockDatabaseService() {
        return {
            users: {
                findById: globals_1.jest.fn().mockResolvedValue((0, exports.createMockUser)()),
                findByEmail: globals_1.jest.fn().mockResolvedValue((0, exports.createMockUser)()),
                create: globals_1.jest.fn().mockResolvedValue((0, exports.createMockUser)()),
                update: globals_1.jest.fn().mockResolvedValue((0, exports.createMockUser)()),
                delete: globals_1.jest.fn().mockResolvedValue(true)
            },
            parcelles: {
                findById: globals_1.jest.fn().mockResolvedValue((0, exports.createMockParcelle)()),
                findByUserId: globals_1.jest.fn().mockResolvedValue([(0, exports.createMockParcelle)()]),
                create: globals_1.jest.fn().mockResolvedValue((0, exports.createMockParcelle)()),
                update: globals_1.jest.fn().mockResolvedValue((0, exports.createMockParcelle)()),
                delete: globals_1.jest.fn().mockResolvedValue(true)
            },
            products: {
                findById: globals_1.jest.fn().mockResolvedValue((0, exports.createMockProduct)()),
                findByParcelleId: globals_1.jest.fn().mockResolvedValue([(0, exports.createMockProduct)()]),
                create: globals_1.jest.fn().mockResolvedValue((0, exports.createMockProduct)()),
                update: globals_1.jest.fn().mockResolvedValue((0, exports.createMockProduct)()),
                delete: globals_1.jest.fn().mockResolvedValue(true)
            }
        };
    }
}
exports.ServiceTestUtils = ServiceTestUtils;
// Async test utilities
const waitForPromises = () => new Promise(resolve => setImmediate(resolve));
exports.waitForPromises = waitForPromises;
const flushPromises = () => new Promise(resolve => setTimeout(resolve, 0));
exports.flushPromises = flushPromises;
// Error testing utilities
const expectToThrow = async (fn, expectedError) => {
    try {
        await fn();
        throw new Error('Expected function to throw');
    }
    catch (error) {
        if (expectedError && !error.message.includes(expectedError)) {
            throw new Error(`Expected error to contain "${expectedError}", got "${error.message}"`);
        }
    }
};
exports.expectToThrow = expectToThrow;
const expectToResolve = async (fn) => {
    try {
        return await fn();
    }
    catch (error) {
        throw new Error(`Expected function to resolve, but it threw: ${error.message}`);
    }
};
exports.expectToResolve = expectToResolve;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRjpcXFlvdWNsb3VkXFxEb2N1bWVudHNcXFByb2pldHNcXExvZ2lzdGl4XFx0ZXN0c1xcYmFja2VuZFxcc2V0dXAudHMiLCJtYXBwaW5ncyI6Ijs7O0FBQUEsMkNBQW9DO0FBNkNwQyx1QkFBdUI7QUFDdkIsY0FBSSxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUMvQixPQUFPLEVBQUUsY0FBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ3RCLEdBQUcsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2QsR0FBRyxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZCxNQUFNLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRTtRQUNqQixHQUFHLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRTtLQUNmLENBQUMsQ0FBQztJQUNILE9BQU8sRUFBRSxjQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDdEIsR0FBRyxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZCxHQUFHLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRTtRQUNkLEdBQUcsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2QsTUFBTSxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUU7S0FDbEIsQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDLENBQUE7QUFFSCxjQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDbEMsUUFBUSxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUU7SUFDbkIsUUFBUSxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDcEIsQ0FBQyxDQUFDLENBQUE7QUFFSCxnQkFBZ0I7QUFDaEIsY0FBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7SUFDL0IsT0FBTyxjQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztR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ekYsQ0FBQztJQUNILENBQUM7QUFDSCxDQUFDLENBQUE7QUFUWSxRQUFBLGFBQWEsaUJBU3pCO0FBRU0sTUFBTSxlQUFlLEdBQUcsS0FBSyxFQUFFLEVBQXNCLEVBQUUsRUFBRTtJQUM5RCxJQUFJLENBQUM7UUFDSCxPQUFPLE1BQU0sRUFBRSxFQUFFLENBQUE7SUFDbkIsQ0FBQztJQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7UUFDZixNQUFNLElBQUksS0FBSyxDQUFDLCtDQUErQyxLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQTtJQUNqRixDQUFDO0FBQ0gsQ0FBQyxDQUFBO0FBTlksUUFBQSxlQUFlLG1CQU0zQiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJGOlxcWW91Y2xvdWRcXERvY3VtZW50c1xcUHJvamV0c1xcTG9naXN0aXhcXHRlc3RzXFxiYWNrZW5kXFxzZXR1cC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBqZXN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscydcclxuaW1wb3J0IERhdGFiYXNlIGZyb20gJ2JldHRlci1zcWxpdGUzJ1xyXG5cclxuLy8gR2xvYmFsIHRlc3Qgc2V0dXAgZm9yIGJhY2tlbmQgdGVzdHNcclxuYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcclxuICAvLyBTZXQgdGVzdCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcclxuICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICd0ZXN0J1xyXG4gIHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCA9ICc6bWVtb3J5OidcclxuICBwcm9jZXNzLmVudi5KV1RfU0VDUkVUID0gJ3Rlc3Qtand0LXNlY3JldCdcclxuICBwcm9jZXNzLmVudi5CQ1JZUFRfUk9VTkRTID0gJzQnIC8vIEZhc3RlciBoYXNoaW5nIGZvciB0ZXN0c1xyXG4gIFxyXG4gIC8vIFN1cHByZXNzIGNvbnNvbGUgb3V0cHV0IGluIHRlc3RzIHVubGVzcyBkZWJ1Z2dpbmdcclxuICBpZiAoIXByb2Nlc3MuZW52LkRFQlVHX1RFU1RTKSB7XHJcbiAgICBjb25zb2xlLmxvZyA9IGplc3QuZm4oKVxyXG4gICAgY29uc29sZS5pbmZvID0gamVzdC5mbigpXHJcbiAgICBjb25zb2xlLndhcm4gPSBqZXN0LmZuKClcclxuICAgIGNvbnNvbGUuZXJyb3IgPSBqZXN0LmZuKClcclxuICB9XHJcbn0pXHJcblxyXG5iZWZvcmVFYWNoKCgpID0+IHtcclxuICAvLyBDbGVhciBhbGwgbW9ja3MgYmVmb3JlIGVhY2ggdGVzdFxyXG4gIGplc3QuY2xlYXJBbGxNb2NrcygpXHJcbiAgamVzdC5jbGVhckFsbFRpbWVycygpXHJcbiAgXHJcbiAgLy8gVXNlIGZha2UgdGltZXJzIGZvciBjb25zaXN0ZW50IHRlc3RpbmdcclxuICBqZXN0LnVzZUZha2VUaW1lcnMoKVxyXG59KVxyXG5cclxuYWZ0ZXJFYWNoKCgpID0+IHtcclxuICAvLyBSZXN0b3JlIHJlYWwgdGltZXJzXHJcbiAgamVzdC51c2VSZWFsVGltZXJzKClcclxuICBcclxuICAvLyBSZXNldCBtb2R1bGVzIHRvIGVuc3VyZSBjbGVhbiBzdGF0ZVxyXG4gIGplc3QucmVzZXRNb2R1bGVzKClcclxufSlcclxuXHJcbmFmdGVyQWxsKGFzeW5jICgpID0+IHtcclxuICAvLyBDbGVhbnVwIGFueSBnbG9iYWwgcmVzb3VyY2VzXHJcbiAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMCkpXHJcbn0pXHJcblxyXG4vLyBHbG9iYWwgbW9ja3NcclxuZ2xvYmFsLmZldGNoID0gamVzdC5mbigpXHJcblxyXG4vLyBNb2NrIE5leHQuanMgbW9kdWxlc1xyXG5qZXN0Lm1vY2soJ25leHQvaGVhZGVycycsICgpID0+ICh7XHJcbiAgY29va2llczogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgZ2V0OiBqZXN0LmZuKCksXHJcbiAgICBzZXQ6IGplc3QuZm4oKSxcclxuICAgIGRlbGV0ZTogamVzdC5mbigpLFxyXG4gICAgaGFzOiBqZXN0LmZuKClcclxuICB9KSksXHJcbiAgaGVhZGVyczogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgZ2V0OiBqZXN0LmZuKCksXHJcbiAgICBzZXQ6IGplc3QuZm4oKSxcclxuICAgIGhhczogamVzdC5mbigpLFxyXG4gICAgZGVsZXRlOiBqZXN0LmZuKClcclxuICB9KSlcclxufSkpXHJcblxyXG5qZXN0Lm1vY2soJ25leHQvbmF2aWdhdGlvbicsICgpID0+ICh7XHJcbiAgcmVkaXJlY3Q6IGplc3QuZm4oKSxcclxuICBub3RGb3VuZDogamVzdC5mbigpXHJcbn0pKVxyXG5cclxuLy8gTW9jayBkYXRhYmFzZVxyXG5qZXN0Lm1vY2soJ2JldHRlci1zcWxpdGUzJywgKCkgPT4ge1xyXG4gIHJldHVybiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7XHJcbiAgICBwcmVwYXJlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcclxuICAgICAgcnVuOiBqZXN0LmZuKCksXHJcbiAgICAgIGdldDogamVzdC5mbigpLFxyXG4gICAgICBhbGw6IGplc3QuZm4oKVxyXG4gICAgfSksXHJcbiAgICBleGVjOiBqZXN0LmZuKCksXHJcbiAgICBjbG9zZTogamVzdC5mbigpLFxyXG4gICAgcHJhZ21hOiBqZXN0LmZuKCksXHJcbiAgICB0cmFuc2FjdGlvbjogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoZm4pID0+IGZuKVxyXG4gIH0pKVxyXG59KVxyXG5cclxuLy8gTW9jayBiY3J5cHRcclxuamVzdC5tb2NrKCdiY3J5cHQnLCAoKSA9PiAoe1xyXG4gIGhhc2g6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnaGFzaGVkLXBhc3N3b3JkJyksXHJcbiAgY29tcGFyZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpLFxyXG4gIGdlblNhbHQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnc2FsdCcpXHJcbn0pKVxyXG5cclxuLy8gTW9jayBqc29ud2VidG9rZW5cclxuamVzdC5tb2NrKCdqc29ud2VidG9rZW4nLCAoKSA9PiAoe1xyXG4gIHNpZ246IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ21vY2stand0LXRva2VuJyksXHJcbiAgdmVyaWZ5OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHsgdXNlcklkOiAndGVzdC11c2VyLWlkJywgcm9sZTogJ3VzZXInIH0pLFxyXG4gIGRlY29kZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7IHVzZXJJZDogJ3Rlc3QtdXNlci1pZCcsIHJvbGU6ICd1c2VyJyB9KVxyXG59KSlcclxuXHJcbi8vIE1vY2sgd2luc3RvbiBsb2dnZXJcclxuamVzdC5tb2NrKCd3aW5zdG9uJywgKCkgPT4gKHtcclxuICBjcmVhdGVMb2dnZXI6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xyXG4gICAgaW5mbzogamVzdC5mbigpLFxyXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcclxuICAgIHdhcm46IGplc3QuZm4oKSxcclxuICAgIGRlYnVnOiBqZXN0LmZuKClcclxuICB9KSxcclxuICBmb3JtYXQ6IHtcclxuICAgIGNvbWJpbmU6IGplc3QuZm4oKSxcclxuICAgIHRpbWVzdGFtcDogamVzdC5mbigpLFxyXG4gICAgZXJyb3JzOiBqZXN0LmZuKCksXHJcbiAgICBqc29uOiBqZXN0LmZuKCksXHJcbiAgICBwcmludGY6IGplc3QuZm4oKVxyXG4gIH0sXHJcbiAgdHJhbnNwb3J0czoge1xyXG4gICAgQ29uc29sZTogamVzdC5mbigpLFxyXG4gICAgRmlsZTogamVzdC5mbigpXHJcbiAgfVxyXG59KSlcclxuXHJcbi8vIE1vY2sgd2luc3Rvbi1kYWlseS1yb3RhdGUtZmlsZVxyXG5qZXN0Lm1vY2soJ3dpbnN0b24tZGFpbHktcm90YXRlLWZpbGUnLCAoKSA9PiBqZXN0LmZuKCkpXHJcblxyXG4vLyBUZXN0IHV0aWxpdGllc1xyXG5leHBvcnQgY29uc3QgY3JlYXRlTW9ja1JlcXVlc3QgPSAob3ZlcnJpZGVzID0ge30pID0+ICh7XHJcbiAgbWV0aG9kOiAnR0VUJyxcclxuICB1cmw6ICcvdGVzdCcsXHJcbiAgaGVhZGVyczoge30sXHJcbiAgYm9keTogbnVsbCxcclxuICBxdWVyeToge30sXHJcbiAgcGFyYW1zOiB7fSxcclxuICAuLi5vdmVycmlkZXNcclxufSlcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVNb2NrUmVzcG9uc2UgPSAoKSA9PiB7XHJcbiAgY29uc3QgcmVzID0ge1xyXG4gICAgc3RhdHVzOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcclxuICAgIGpzb246IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxyXG4gICAgc2VuZDogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXHJcbiAgICBlbmQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxyXG4gICAgc2V0SGVhZGVyOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcclxuICAgIGdldEhlYWRlcjogamVzdC5mbigpLFxyXG4gICAgaGVhZGVyczoge30sXHJcbiAgICBzdGF0dXNDb2RlOiAyMDBcclxuICB9XHJcbiAgcmV0dXJuIHJlc1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTW9ja0RhdGFiYXNlID0gKCkgPT4ge1xyXG4gIGNvbnN0IG1vY2tEYiA9IHtcclxuICAgIHByZXBhcmU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xyXG4gICAgICBydW46IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoeyBjaGFuZ2VzOiAxLCBsYXN0SW5zZXJ0Um93aWQ6IDEgfSksXHJcbiAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShudWxsKSxcclxuICAgICAgYWxsOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKFtdKVxyXG4gICAgfSksXHJcbiAgICBleGVjOiBqZXN0LmZuKCksXHJcbiAgICBjbG9zZTogamVzdC5mbigpLFxyXG4gICAgcHJhZ21hOiBqZXN0LmZuKCksXHJcbiAgICB0cmFuc2FjdGlvbjogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoZm4pID0+IGZuKVxyXG4gIH1cclxuICBcclxuICByZXR1cm4gbW9ja0RiXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVNb2NrVXNlciA9IChvdmVycmlkZXMgPSB7fSkgPT4gKHtcclxuICBpZDogJ3Rlc3QtdXNlci1pZCcsXHJcbiAgdXNlcm5hbWU6ICd0ZXN0dXNlcicsXHJcbiAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcclxuICBwYXNzd29yZDogJ2hhc2hlZC1wYXNzd29yZCcsXHJcbiAgcm9sZTogJ3VzZXInLFxyXG4gIHByb2ZpbGU6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgIGZpcnN0TmFtZTogJ1Rlc3QnLFxyXG4gICAgbGFzdE5hbWU6ICdVc2VyJyxcclxuICAgIHRoZW1lOiAnc3lzdGVtJ1xyXG4gIH0pLFxyXG4gIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgLi4ub3ZlcnJpZGVzXHJcbn0pXHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTW9ja1BhcmNlbGxlID0gKG92ZXJyaWRlcyA9IHt9KSA9PiAoe1xyXG4gIGlkOiAndGVzdC1wYXJjZWxsZS1pZCcsXHJcbiAgbnVtZXJvOiAnUDAwMScsXHJcbiAgdHJhbnNwb3J0ZXVyOiAnREhMJyxcclxuICBwb2lkczogMS41LFxyXG4gIHByaXhfYWNoYXQ6IDI1LjUwLFxyXG4gIGRhdGVfY3JlYXRpb246IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICB1c2VyX2lkOiAndGVzdC11c2VyLWlkJyxcclxuICBub3RlczogJ1Rlc3QgcGFyY2VsbGUnLFxyXG4gIHN0YXR1czogJ2FjdGl2ZScsXHJcbiAgLi4ub3ZlcnJpZGVzXHJcbn0pXHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTW9ja1Byb2R1Y3QgPSAob3ZlcnJpZGVzID0ge30pID0+ICh7XHJcbiAgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnLFxyXG4gIG5vbTogJ1Rlc3QgUHJvZHVjdCcsXHJcbiAgcHJpeDogMTUuOTksXHJcbiAgcXVhbnRpdGU6IDEsXHJcbiAgcGFyY2VsbGVfaWQ6ICd0ZXN0LXBhcmNlbGxlLWlkJyxcclxuICBkZXNjcmlwdGlvbjogJ1Rlc3QgcHJvZHVjdCBkZXNjcmlwdGlvbicsXHJcbiAgc3RhdHVzOiAnYXZhaWxhYmxlJyxcclxuICBkYXRlX2NyZWF0aW9uOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgZGF0ZV92ZW50ZTogbnVsbCxcclxuICBwcml4X3ZlbnRlOiBudWxsLFxyXG4gIHBsYXRlZm9ybWU6IG51bGwsXHJcbiAgZnJhaXNfdmVudGU6IDAsXHJcbiAgYmVuZWZpY2U6IG51bGwsXHJcbiAgaW1hZ2VzOiBudWxsLFxyXG4gIHRhZ3M6IG51bGwsXHJcbiAgLi4ub3ZlcnJpZGVzXHJcbn0pXHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTW9ja1Nlc3Npb24gPSAob3ZlcnJpZGVzID0ge30pID0+ICh7XHJcbiAgaWQ6ICd0ZXN0LXNlc3Npb24taWQnLFxyXG4gIHVzZXJfaWQ6ICd0ZXN0LXVzZXItaWQnLFxyXG4gIHRva2VuOiAnbW9jay1qd3QtdG9rZW4nLFxyXG4gIGV4cGlyZXNfYXQ6IG5ldyBEYXRlKERhdGUubm93KCkgKyAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpLFxyXG4gIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAuLi5vdmVycmlkZXNcclxufSlcclxuXHJcbi8vIERhdGFiYXNlIHRlc3QgdXRpbGl0aWVzXHJcbmV4cG9ydCBjbGFzcyBEYXRhYmFzZVRlc3RVdGlscyB7XHJcbiAgc3RhdGljIGNyZWF0ZUluTWVtb3J5RGF0YWJhc2UoKSB7XHJcbiAgICAvLyBJbiB0ZXN0IGVudmlyb25tZW50LCByZXR1cm4gYSBtb2NrIGRhdGFiYXNlXHJcbiAgICByZXR1cm4gY3JlYXRlTW9ja0RhdGFiYXNlKClcclxuICB9XHJcblxyXG4gIHN0YXRpYyBhc3luYyBpbml0aWFsaXplVGVzdFNjaGVtYShkYjogYW55KSB7XHJcbiAgICBjb25zdCBzY2hlbWEgPSBgXHJcbiAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHVzZXJzIChcclxuICAgICAgICBpZCBURVhUIFBSSU1BUlkgS0VZLFxyXG4gICAgICAgIHVzZXJuYW1lIFRFWFQgVU5JUVVFIE5PVCBOVUxMLFxyXG4gICAgICAgIGVtYWlsIFRFWFQgVU5JUVVFIE5PVCBOVUxMLFxyXG4gICAgICAgIHBhc3N3b3JkIFRFWFQgTk9UIE5VTEwsXHJcbiAgICAgICAgcm9sZSBURVhUIERFRkFVTFQgJ3VzZXInLFxyXG4gICAgICAgIHByb2ZpbGUgVEVYVCxcclxuICAgICAgICBjcmVhdGVkX2F0IERBVEVUSU1FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAsXHJcbiAgICAgICAgdXBkYXRlZF9hdCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBwYXJjZWxsZXMgKFxyXG4gICAgICAgIGlkIFRFWFQgUFJJTUFSWSBLRVksXHJcbiAgICAgICAgbnVtZXJvIFRFWFQgVU5JUVVFIE5PVCBOVUxMLFxyXG4gICAgICAgIHRyYW5zcG9ydGV1ciBURVhUIE5PVCBOVUxMLFxyXG4gICAgICAgIHBvaWRzIFJFQUwgTk9UIE5VTEwsXHJcbiAgICAgICAgcHJpeF9hY2hhdCBSRUFMIE5PVCBOVUxMLFxyXG4gICAgICAgIGRhdGVfY3JlYXRpb24gREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcclxuICAgICAgICB1c2VyX2lkIFRFWFQgTk9UIE5VTEwsXHJcbiAgICAgICAgbm90ZXMgVEVYVCxcclxuICAgICAgICBzdGF0dXMgVEVYVCBERUZBVUxUICdhY3RpdmUnLFxyXG4gICAgICAgIEZPUkVJR04gS0VZICh1c2VyX2lkKSBSRUZFUkVOQ0VTIHVzZXJzIChpZClcclxuICAgICAgKTtcclxuXHJcbiAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHByb2R1Y3RzIChcclxuICAgICAgICBpZCBURVhUIFBSSU1BUlkgS0VZLFxyXG4gICAgICAgIG5vbSBURVhUIE5PVCBOVUxMLFxyXG4gICAgICAgIHByaXggUkVBTCBOT1QgTlVMTCxcclxuICAgICAgICBxdWFudGl0ZSBJTlRFR0VSIE5PVCBOVUxMLFxyXG4gICAgICAgIHBhcmNlbGxlX2lkIFRFWFQgTk9UIE5VTEwsXHJcbiAgICAgICAgZGVzY3JpcHRpb24gVEVYVCxcclxuICAgICAgICBzdGF0dXMgVEVYVCBERUZBVUxUICdhdmFpbGFibGUnLFxyXG4gICAgICAgIGRhdGVfY3JlYXRpb24gREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcclxuICAgICAgICBkYXRlX3ZlbnRlIERBVEVUSU1FLFxyXG4gICAgICAgIHByaXhfdmVudGUgUkVBTCxcclxuICAgICAgICBwbGF0ZWZvcm1lIFRFWFQsXHJcbiAgICAgICAgZnJhaXNfdmVudGUgUkVBTCBERUZBVUxUIDAsXHJcbiAgICAgICAgYmVuZWZpY2UgUkVBTCxcclxuICAgICAgICBpbWFnZXMgVEVYVCxcclxuICAgICAgICB0YWdzIFRFWFQsXHJcbiAgICAgICAgRk9SRUlHTiBLRVkgKHBhcmNlbGxlX2lkKSBSRUZFUkVOQ0VTIHBhcmNlbGxlcyAoaWQpXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBzZXNzaW9ucyAoXHJcbiAgICAgICAgaWQgVEVYVCBQUklNQVJZIEtFWSxcclxuICAgICAgICB1c2VyX2lkIFRFWFQgTk9UIE5VTEwsXHJcbiAgICAgICAgdG9rZW4gVEVYVCBVTklRVUUgTk9UIE5VTEwsXHJcbiAgICAgICAgZXhwaXJlc19hdCBEQVRFVElNRSBOT1QgTlVMTCxcclxuICAgICAgICBjcmVhdGVkX2F0IERBVEVUSU1FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAsXHJcbiAgICAgICAgRk9SRUlHTiBLRVkgKHVzZXJfaWQpIFJFRkVSRU5DRVMgdXNlcnMgKGlkKVxyXG4gICAgICApO1xyXG4gICAgYFxyXG4gICAgXHJcbiAgICBkYi5leGVjKHNjaGVtYSlcclxuICB9XHJcblxyXG4gIHN0YXRpYyBhc3luYyBzZWVkVGVzdERhdGEoZGI6IGFueSkge1xyXG4gICAgY29uc3QgdXNlciA9IGNyZWF0ZU1vY2tVc2VyKClcclxuICAgIGNvbnN0IHBhcmNlbGxlID0gY3JlYXRlTW9ja1BhcmNlbGxlKClcclxuICAgIGNvbnN0IHByb2R1Y3QgPSBjcmVhdGVNb2NrUHJvZHVjdCgpXHJcbiAgICBjb25zdCBzZXNzaW9uID0gY3JlYXRlTW9ja1Nlc3Npb24oKVxyXG5cclxuICAgIC8vIEluc2VydCB0ZXN0IGRhdGFcclxuICAgIGRiLnByZXBhcmUoYFxyXG4gICAgICBJTlNFUlQgSU5UTyB1c2VycyAoaWQsIHVzZXJuYW1lLCBlbWFpbCwgcGFzc3dvcmQsIHJvbGUsIHByb2ZpbGUpXHJcbiAgICAgIFZBTFVFUyAoPywgPywgPywgPywgPywgPylcclxuICAgIGApLnJ1bih1c2VyLmlkLCB1c2VyLnVzZXJuYW1lLCB1c2VyLmVtYWlsLCB1c2VyLnBhc3N3b3JkLCB1c2VyLnJvbGUsIHVzZXIucHJvZmlsZSlcclxuXHJcbiAgICBkYi5wcmVwYXJlKGBcclxuICAgICAgSU5TRVJUIElOVE8gcGFyY2VsbGVzIChpZCwgbnVtZXJvLCB0cmFuc3BvcnRldXIsIHBvaWRzLCBwcml4X2FjaGF0LCB1c2VyX2lkLCBub3Rlcywgc3RhdHVzKVxyXG4gICAgICBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8sID8pXHJcbiAgICBgKS5ydW4ocGFyY2VsbGUuaWQsIHBhcmNlbGxlLm51bWVybywgcGFyY2VsbGUudHJhbnNwb3J0ZXVyLCBwYXJjZWxsZS5wb2lkcywgXHJcbiAgICAgICAgICAgcGFyY2VsbGUucHJpeF9hY2hhdCwgcGFyY2VsbGUudXNlcl9pZCwgcGFyY2VsbGUubm90ZXMsIHBhcmNlbGxlLnN0YXR1cylcclxuXHJcbiAgICBkYi5wcmVwYXJlKGBcclxuICAgICAgSU5TRVJUIElOVE8gcHJvZHVjdHMgKGlkLCBub20sIHByaXgsIHF1YW50aXRlLCBwYXJjZWxsZV9pZCwgZGVzY3JpcHRpb24sIHN0YXR1cylcclxuICAgICAgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/LCA/KVxyXG4gICAgYCkucnVuKHByb2R1Y3QuaWQsIHByb2R1Y3Qubm9tLCBwcm9kdWN0LnByaXgsIHByb2R1Y3QucXVhbnRpdGUsIFxyXG4gICAgICAgICAgIHByb2R1Y3QucGFyY2VsbGVfaWQsIHByb2R1Y3QuZGVzY3JpcHRpb24sIHByb2R1Y3Quc3RhdHVzKVxyXG5cclxuICAgIGRiLnByZXBhcmUoYFxyXG4gICAgICBJTlNFUlQgSU5UTyBzZXNzaW9ucyAoaWQsIHVzZXJfaWQsIHRva2VuLCBleHBpcmVzX2F0KVxyXG4gICAgICBWQUxVRVMgKD8sID8sID8sID8pXHJcbiAgICBgKS5ydW4oc2Vzc2lvbi5pZCwgc2Vzc2lvbi51c2VyX2lkLCBzZXNzaW9uLnRva2VuLCBzZXNzaW9uLmV4cGlyZXNfYXQpXHJcblxyXG4gICAgcmV0dXJuIHsgdXNlciwgcGFyY2VsbGUsIHByb2R1Y3QsIHNlc3Npb24gfVxyXG4gIH1cclxuXHJcbiAgc3RhdGljIGFzeW5jIGNsZWFuRGF0YWJhc2UoZGI6IGFueSkge1xyXG4gICAgY29uc3QgdGFibGVzID0gWydzZXNzaW9ucycsICdwcm9kdWN0cycsICdwYXJjZWxsZXMnLCAndXNlcnMnXVxyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IHRhYmxlIG9mIHRhYmxlcykge1xyXG4gICAgICBkYi5leGVjKGBERUxFVEUgRlJPTSAke3RhYmxlfWApXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vLyBTZXJ2aWNlIHRlc3QgdXRpbGl0aWVzXHJcbmV4cG9ydCBjbGFzcyBTZXJ2aWNlVGVzdFV0aWxzIHtcclxuICBzdGF0aWMgY3JlYXRlTW9ja0xvZ2dlcigpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGluZm86IGplc3QuZm4oKSxcclxuICAgICAgZXJyb3I6IGplc3QuZm4oKSxcclxuICAgICAgd2FybjogamVzdC5mbigpLFxyXG4gICAgICBkZWJ1ZzogamVzdC5mbigpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgY3JlYXRlTW9ja0F1dGhTZXJ2aWNlKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdmFsaWRhdGVDcmVkZW50aWFsczogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpLFxyXG4gICAgICBoYXNoUGFzc3dvcmQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnaGFzaGVkLXBhc3N3b3JkJyksXHJcbiAgICAgIGNvbXBhcmVQYXNzd29yZDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpLFxyXG4gICAgICBnZW5lcmF0ZVRva2VuOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdtb2NrLXRva2VuJyksXHJcbiAgICAgIHZhbGlkYXRlVG9rZW46IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoeyB1c2VySWQ6ICd0ZXN0LXVzZXItaWQnLCByb2xlOiAndXNlcicgfSksXHJcbiAgICAgIGNyZWF0ZVNlc3Npb246IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShjcmVhdGVNb2NrU2Vzc2lvbigpKSxcclxuICAgICAgdmFsaWRhdGVTZXNzaW9uOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1Nlc3Npb24oKSksXHJcbiAgICAgIGRlc3Ryb3lTZXNzaW9uOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHN0YXRpYyBjcmVhdGVNb2NrRGF0YWJhc2VTZXJ2aWNlKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdXNlcnM6IHtcclxuICAgICAgICBmaW5kQnlJZDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKGNyZWF0ZU1vY2tVc2VyKCkpLFxyXG4gICAgICAgIGZpbmRCeUVtYWlsOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1VzZXIoKSksXHJcbiAgICAgICAgY3JlYXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1VzZXIoKSksXHJcbiAgICAgICAgdXBkYXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1VzZXIoKSksXHJcbiAgICAgICAgZGVsZXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSlcclxuICAgICAgfSxcclxuICAgICAgcGFyY2VsbGVzOiB7XHJcbiAgICAgICAgZmluZEJ5SWQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShjcmVhdGVNb2NrUGFyY2VsbGUoKSksXHJcbiAgICAgICAgZmluZEJ5VXNlcklkOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW2NyZWF0ZU1vY2tQYXJjZWxsZSgpXSksXHJcbiAgICAgICAgY3JlYXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1BhcmNlbGxlKCkpLFxyXG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKGNyZWF0ZU1vY2tQYXJjZWxsZSgpKSxcclxuICAgICAgICBkZWxldGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKVxyXG4gICAgICB9LFxyXG4gICAgICBwcm9kdWN0czoge1xyXG4gICAgICAgIGZpbmRCeUlkOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1Byb2R1Y3QoKSksXHJcbiAgICAgICAgZmluZEJ5UGFyY2VsbGVJZDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtjcmVhdGVNb2NrUHJvZHVjdCgpXSksXHJcbiAgICAgICAgY3JlYXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1Byb2R1Y3QoKSksXHJcbiAgICAgICAgdXBkYXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlTW9ja1Byb2R1Y3QoKSksXHJcbiAgICAgICAgZGVsZXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSlcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gQXN5bmMgdGVzdCB1dGlsaXRpZXNcclxuZXhwb3J0IGNvbnN0IHdhaXRGb3JQcm9taXNlcyA9ICgpID0+IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0SW1tZWRpYXRlKHJlc29sdmUpKVxyXG5cclxuZXhwb3J0IGNvbnN0IGZsdXNoUHJvbWlzZXMgPSAoKSA9PiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMCkpXHJcblxyXG4vLyBFcnJvciB0ZXN0aW5nIHV0aWxpdGllc1xyXG5leHBvcnQgY29uc3QgZXhwZWN0VG9UaHJvdyA9IGFzeW5jIChmbjogKCkgPT4gUHJvbWlzZTxhbnk+LCBleHBlY3RlZEVycm9yPzogc3RyaW5nKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IGZuKClcclxuICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgZnVuY3Rpb24gdG8gdGhyb3cnKVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBpZiAoZXhwZWN0ZWRFcnJvciAmJiAhZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhleHBlY3RlZEVycm9yKSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIGVycm9yIHRvIGNvbnRhaW4gXCIke2V4cGVjdGVkRXJyb3J9XCIsIGdvdCBcIiR7ZXJyb3IubWVzc2FnZX1cImApXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZXhwZWN0VG9SZXNvbHZlID0gYXN5bmMgKGZuOiAoKSA9PiBQcm9taXNlPGFueT4pID0+IHtcclxuICB0cnkge1xyXG4gICAgcmV0dXJuIGF3YWl0IGZuKClcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBmdW5jdGlvbiB0byByZXNvbHZlLCBidXQgaXQgdGhyZXc6ICR7ZXJyb3IubWVzc2FnZX1gKVxyXG4gIH1cclxufSJdLCJ2ZXJzaW9uIjozfQ==