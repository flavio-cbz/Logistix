[INFO] Scanning API endpoints...
[INFO] Analyzing security issues...
================================================================================
API Security Analysis Report
Generated: 2025-10-15T21:36:34.004Z
================================================================================

## SUMMARY
- Total Endpoints: 30
- With Authentication: 4
- With Input Validation: 6
- With Rate Limiting: 2
- Security Issues Found: 26

## API ENDPOINTS (30)
────────────────────────────────────────────────────────────────────────────────
🔓 health/
   Methods: GET, HEAD
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/auth/login/
   Methods: POST
   Middlewares: withErrorHandling
   Auth: ✗ | Validation: ✓ | Rate Limit: ✓

🔓 v1/auth/logout/
   Methods: POST
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/auth/register/
   Methods: POST
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/auth/session-check/
   Methods: GET
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔒 v1/auth/signup/
   Methods: GET, POST
   Middlewares: requireAuth
   Auth: ✓ | Validation: ✓ | Rate Limit: ✓

🔓 v1/auth/validate-session/
   Methods: GET
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/cache/clear/
   Methods: POST
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/dashboard/
   Methods: GET
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/health/
   Methods: GET
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/load-test/
   Methods: GET, POST
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/metrics/http/
   Methods: GET
   Middlewares: requireAdmin
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/metrics/performance/
   Methods: GET, DELETE
   Middlewares: requireAdmin
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/monitoring/health/
   Methods: GET, POST
   Middlewares: withErrorHandling
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/parcelles/
   Methods: GET, POST
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/parcelles/stats/
   Methods: GET
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/parcelles/[id]/products/
   Methods: GET
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔒 v1/parcelles/[id]/
   Methods: PATCH, DELETE
   Middlewares: withErrorHandling, requireAuth
   Auth: ✓ | Validation: ✓ | Rate Limit: ✗

🔓 v1/produits/
   Methods: GET, POST
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/produits/stats/
   Methods: GET
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔒 v1/produits/[id]/duplicate/
   Methods: POST
   Middlewares: requireAuth
   Auth: ✓ | Validation: ✗ | Rate Limit: ✗

🔓 v1/produits/[id]/
   Methods: GET, PUT, DELETE
   Auth: ✗ | Validation: ✓ | Rate Limit: ✗

🔒 v1/produits/[id]/sales/
   Methods: GET, POST
   Middlewares: requireAuth
   Auth: ✓ | Validation: ✓ | Rate Limit: ✗

🔓 v1/profile/change-password/
   Methods: POST
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/profile/
   Methods: GET, PUT
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/sessions/
   Methods: GET, DELETE
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/sessions/[id]/
   Methods: DELETE
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/settings/
   Methods: GET, PUT
   Auth: ✗ | Validation: ✓ | Rate Limit: ✗

🔓 v1/statistiques/
   Methods: GET
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

🔓 v1/upload/
   Methods: POST
   Auth: ✗ | Validation: ✗ | Rate Limit: ✗

## SECURITY ISSUES (26)
────────────────────────────────────────────────────────────────────────────────

### HIGH SEVERITY (22)
⚠️  health/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/auth/logout/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/auth/session-check/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/auth/validate-session/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/cache/clear/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/dashboard/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/load-test/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/metrics/http/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/metrics/performance/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/parcelles/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/parcelles/stats/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/parcelles/[id]/products/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/produits/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/produits/stats/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/produits/[id]/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/profile/change-password/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/profile/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/sessions/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/sessions/[id]/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/settings/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/statistiques/: Missing authentication
    → Add requireAuth() middleware

⚠️  v1/upload/: Missing authentication
    → Add requireAuth() middleware


### MEDIUM SEVERITY (4)
⚡ v1/profile/change-password/: Missing input validation
    → Add validateRequest() middleware with Zod schema

⚡ v1/profile/: Missing input validation
    → Add validateRequest() middleware with Zod schema

⚡ v1/sessions/: Missing input validation
    → Add validateRequest() middleware with Zod schema

⚡ v1/sessions/[id]/: Missing input validation
    → Add validateRequest() middleware with Zod schema

## RECOMMENDATIONS
────────────────────────────────────────────────────────────────────────────────
1. Ensure all protected endpoints use requireAuth() middleware
2. Implement input validation for all endpoints accepting user data
3. Add rate limiting to authentication endpoints
4. Use HTTPS in production (enforced by deployment)
5. Rotate secrets regularly (API keys, JWT secrets, etc.)
6. Monitor failed login attempts and suspicious activity
7. Keep dependencies updated and scan for vulnerabilities

================================================================================
Exit Code: 1

